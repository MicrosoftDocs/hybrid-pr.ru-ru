---
title: Шаблон DevOps для Azure Stack Hub
description: Узнайте о шаблоне DevOps, чтобы обеспечить согласованность между развертываниями в Azure и Azure Stack Hub.
author: BryanLa
ms.topic: article
ms.date: 11/05/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 11/05/2019
ms.openlocfilehash: e26056a9507a7467473b009725d4f210d9d59ec8
ms.sourcegitcommit: d2def847937178f68177507be151df2aa8e25d53
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/20/2020
ms.locfileid: "86477241"
---
# <a name="devops-pattern"></a><span data-ttu-id="e78c2-103">Шаблон DevOps</span><span class="sxs-lookup"><span data-stu-id="e78c2-103">DevOps pattern</span></span>

<span data-ttu-id="e78c2-104">Создайте код в одном расположении и разверните его в нескольких целевых расположениях в среде разработки, среде тестирования и рабочей среде, которые могут находиться в локальном центре обработки данных, в частных облаках или в общедоступном облаке.</span><span class="sxs-lookup"><span data-stu-id="e78c2-104">Code from a single location and deploy to multiple targets in development, test, and production environments that may be in your local datacenter, private clouds, or the public cloud.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="e78c2-105">Контекст и проблема</span><span class="sxs-lookup"><span data-stu-id="e78c2-105">Context and problem</span></span>

<span data-ttu-id="e78c2-106">Непрерывность, безопасность и надежность развертывания приложений являются ключевыми для организации и критически важными для команд разработчиков.</span><span class="sxs-lookup"><span data-stu-id="e78c2-106">Application deployment continuity, security, and reliability are essential to organizations and critical to development teams.</span></span>

<span data-ttu-id="e78c2-107">Приложениям часто требуется рефакторинг кода для выполнения в каждой целевой среде.</span><span class="sxs-lookup"><span data-stu-id="e78c2-107">Apps often require refactored code to run in each target environment.</span></span> <span data-ttu-id="e78c2-108">Это означает, что приложение не является полностью переносимым.</span><span class="sxs-lookup"><span data-stu-id="e78c2-108">This means that an app isn't completely portable.</span></span> <span data-ttu-id="e78c2-109">Оно должно быть обновлено, протестировано и проверено для перемещения в каждую среду.</span><span class="sxs-lookup"><span data-stu-id="e78c2-109">It must be updated, tested, and validated as it moves through each environment.</span></span> <span data-ttu-id="e78c2-110">Например, код, написанный в среде разработки, должен быть переписан для использования в тестовой среде, а затем снова переписан, когда он наконец окажется в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="e78c2-110">For example, code written in a development environment must then be rewritten to work in a test environment and rewritten when it finally lands in a production environment.</span></span> <span data-ttu-id="e78c2-111">Кроме того, этот код особенно привязан к узлу.</span><span class="sxs-lookup"><span data-stu-id="e78c2-111">Furthermore, this code is specifically tied to the host.</span></span> <span data-ttu-id="e78c2-112">Это повышает стоимость и сложность обслуживания приложения.</span><span class="sxs-lookup"><span data-stu-id="e78c2-112">This increases the cost and complexity of maintaining your app.</span></span> <span data-ttu-id="e78c2-113">Каждая версия приложения привязана к отдельной среде.</span><span class="sxs-lookup"><span data-stu-id="e78c2-113">Each version of the app is tied to each environment.</span></span> <span data-ttu-id="e78c2-114">Повышенная сложность и дублирование увеличивают риск нарушения безопасности и снижения качества кода.</span><span class="sxs-lookup"><span data-stu-id="e78c2-114">The increased complexity and duplication increase the risk of security and code quality.</span></span> <span data-ttu-id="e78c2-115">Кроме того, код нельзя повторно развернуть при удалении и восстановлении неработоспособных узлов или развертывании дополнительных узлов в соответствии с изменяющимися требованиями.</span><span class="sxs-lookup"><span data-stu-id="e78c2-115">In addition, the code can't be readily redeployed when you remove restore failed hosts or deploy additional hosts to handle increases in demand.</span></span>

## <a name="solution"></a><span data-ttu-id="e78c2-116">Решение</span><span class="sxs-lookup"><span data-stu-id="e78c2-116">Solution</span></span>

<span data-ttu-id="e78c2-117">Шаблон DevOps позволяет создать, протестировать и развернуть приложение, работающее в нескольких облаках.</span><span class="sxs-lookup"><span data-stu-id="e78c2-117">The DevOps Pattern enables you to build, test, and deploy an app that runs on multiple clouds.</span></span> <span data-ttu-id="e78c2-118">Этот шаблон основан на технологии непрерывной интеграции и непрерывной поставки.</span><span class="sxs-lookup"><span data-stu-id="e78c2-118">This pattern unites the practice of continuous integration and continuous delivery.</span></span> <span data-ttu-id="e78c2-119">Благодаря непрерывной интеграции код создается и тестируется каждый раз, когда член команды фиксирует изменения в системе управления версиями.</span><span class="sxs-lookup"><span data-stu-id="e78c2-119">With continuous integration, code is built and tested every time a team member commits a change to version control.</span></span> <span data-ttu-id="e78c2-120">Непрерывная поставка позволяет автоматизировать воспроизведение каждого шага в среде сборки в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="e78c2-120">Continuous delivery automates each step from a build to a production environment.</span></span> <span data-ttu-id="e78c2-121">Вместе эти процессы образуют процесс выпуска, который поддерживает развертывание в различных средах.</span><span class="sxs-lookup"><span data-stu-id="e78c2-121">Together, these processes create a release process that supports deployment across diverse environments.</span></span> <span data-ttu-id="e78c2-122">С помощью этого шаблона можно создать черновик кода, а затем развертывать один и тот же код в локальной среде, в разных частных облаках и в общедоступных облаках.</span><span class="sxs-lookup"><span data-stu-id="e78c2-122">With this pattern, you can draft your code and then deploy the same code to a premise environment, different private clouds, and the public clouds.</span></span> <span data-ttu-id="e78c2-123">Различия в среде требуют изменения файла конфигурации, а не внесения изменений в код.</span><span class="sxs-lookup"><span data-stu-id="e78c2-123">Differences in environment require a change to a configuration file rather than changes to the code.</span></span>

![Шаблон DevOps](media/pattern-cicd-pipeline/hybrid-ci-cd.png)

<span data-ttu-id="e78c2-125">Благодаря согласованному набору средств разработки в локальной среде, частном облаке и общедоступном облаке можно реализовать методику непрерывной интеграции и непрерывной поставки.</span><span class="sxs-lookup"><span data-stu-id="e78c2-125">With a consistent set of development tools across on-premises, private cloud, and public cloud environments, you can implement a practice of continuous integration and continuous delivery.</span></span> <span data-ttu-id="e78c2-126">Приложения и службы, развертываемые с помощью шаблона DevOps, взаимозаменяемы и могут выполняться в любой среде, используя функции локальной среды и возможности общедоступного облака.</span><span class="sxs-lookup"><span data-stu-id="e78c2-126">Apps and services deployed using the DevOps Pattern are interchangeable and can run in any of these locations, taking advantage of on-premises and public cloud features and capabilities.</span></span>

<span data-ttu-id="e78c2-127">Использование конвейера выпуска DevOps помогает:</span><span class="sxs-lookup"><span data-stu-id="e78c2-127">Using a DevOps release pipeline helps you:</span></span>

- <span data-ttu-id="e78c2-128">инициировать новую сборку при фиксации кода в одном репозитории;</span><span class="sxs-lookup"><span data-stu-id="e78c2-128">Initiate a new build based on code commits to a single repository.</span></span>
- <span data-ttu-id="e78c2-129">автоматически развернуть новый созданный код в общедоступном облаке для пользовательского приемочного тестирования;</span><span class="sxs-lookup"><span data-stu-id="e78c2-129">Automatically deploy your newly built code to the public cloud for user acceptance testing.</span></span>
- <span data-ttu-id="e78c2-130">автоматически развернуть код, прошедший тестирование, в общедоступном облаке.</span><span class="sxs-lookup"><span data-stu-id="e78c2-130">Automatically deploy to a private cloud once your code has passed testing.</span></span>

## <a name="issues-and-considerations"></a><span data-ttu-id="e78c2-131">Проблемы и рекомендации</span><span class="sxs-lookup"><span data-stu-id="e78c2-131">Issues and considerations</span></span>

<span data-ttu-id="e78c2-132">Шаблон DevOps предназначен обеспечить согласованность развертываний независимо от целевой среды.</span><span class="sxs-lookup"><span data-stu-id="e78c2-132">The DevOps Pattern is intended to ensure consistency across deployments regardless of the target environment.</span></span> <span data-ttu-id="e78c2-133">Однако его возможности в облачных и локальных средах различны.</span><span class="sxs-lookup"><span data-stu-id="e78c2-133">However, capabilities vary across cloud and on-premises environments.</span></span> <span data-ttu-id="e78c2-134">Учтите следующие моменты.</span><span class="sxs-lookup"><span data-stu-id="e78c2-134">Consider the following points:</span></span>

- <span data-ttu-id="e78c2-135">Функции, конечные точки, службы и другие ресурсы в развертывании доступны во целевых расположениях развертывания?</span><span class="sxs-lookup"><span data-stu-id="e78c2-135">Are the functions, endpoints, services, and other resources in your deployment available in the target deployment locations?</span></span>
- <span data-ttu-id="e78c2-136">Хранятся ли артефакты конфигурации в расположениях, доступных для разных облаков?</span><span class="sxs-lookup"><span data-stu-id="e78c2-136">Are configuration artifacts stored in locations that are accessible across clouds?</span></span>
- <span data-ttu-id="e78c2-137">Будут ли параметры развертывания работать во всех целевых средах?</span><span class="sxs-lookup"><span data-stu-id="e78c2-137">Will deployment parameters work in all the target environments?</span></span>
- <span data-ttu-id="e78c2-138">Доступны ли свойства, определяемые ресурсами, в целевых облаках?</span><span class="sxs-lookup"><span data-stu-id="e78c2-138">Are resource-specific properties available in all target clouds?</span></span>

<span data-ttu-id="e78c2-139">Дополнительные сведения см. в разделе [Разработка шаблонов Azure Resource Manager для обеспечения согласованности с облаком](/azure/azure-resource-manager/templates-cloud-consistency).</span><span class="sxs-lookup"><span data-stu-id="e78c2-139">For more information, see [Develop Azure Resource Manager templates for cloud consistency](/azure/azure-resource-manager/templates-cloud-consistency).</span></span>

<span data-ttu-id="e78c2-140">Кроме того, при выборе способа реализации этого шаблона следует учитывать следующее.</span><span class="sxs-lookup"><span data-stu-id="e78c2-140">In addition, consider the following points when deciding how to implement this pattern:</span></span>

### <a name="scalability"></a><span data-ttu-id="e78c2-141">Масштабируемость</span><span class="sxs-lookup"><span data-stu-id="e78c2-141">Scalability</span></span>

<span data-ttu-id="e78c2-142">Системы автоматизации развертывания являются ключевой контрольной точкой в шаблонах DevOps.</span><span class="sxs-lookup"><span data-stu-id="e78c2-142">Deployment automation systems are the key control point in the DevOps Patterns.</span></span> <span data-ttu-id="e78c2-143">Варианты реализации могут быть различны.</span><span class="sxs-lookup"><span data-stu-id="e78c2-143">Implementations can vary.</span></span> <span data-ttu-id="e78c2-144">Выбор правильного размера сервера зависит от объема ожидаемой рабочей нагрузки.</span><span class="sxs-lookup"><span data-stu-id="e78c2-144">The selection of the correct server size depends on the size of the expected workload.</span></span> <span data-ttu-id="e78c2-145">Масштабировать виртуальные машины затратнее, чем контейнеры.</span><span class="sxs-lookup"><span data-stu-id="e78c2-145">VMs cost more to scale than containers.</span></span> <span data-ttu-id="e78c2-146">Но если для масштабирования нужно использовать контейнеры, их нужно применять и в процессе сборки.</span><span class="sxs-lookup"><span data-stu-id="e78c2-146">To use containers for scaling, however, your build process must run with containers.</span></span>

### <a name="availability"></a><span data-ttu-id="e78c2-147">Доступность</span><span class="sxs-lookup"><span data-stu-id="e78c2-147">Availability</span></span>

<span data-ttu-id="e78c2-148">Доступность в контексте сервера шаблона DevOps означает возможность восстановления сведений о состоянии, связанных с рабочим процессом, например результатов теста, зависимостей кода или других артефактов.</span><span class="sxs-lookup"><span data-stu-id="e78c2-148">Availability in the context of the DevPattern means being able to recover any state information associated with your workflow, such as test results, code dependencies, or other artifacts.</span></span> <span data-ttu-id="e78c2-149">Для оценки требований к доступности рекомендуем использовать две общие метрики:</span><span class="sxs-lookup"><span data-stu-id="e78c2-149">To assess your availability requirements, consider two common metrics:</span></span>

- <span data-ttu-id="e78c2-150">Целевое время восстановления (RTO) указывает, как долго вы сможете обходиться без системы.</span><span class="sxs-lookup"><span data-stu-id="e78c2-150">Recovery Time Objective (RTO) specifies how long you can go without a system.</span></span>

- <span data-ttu-id="e78c2-151">Целевая точка восстановления (RPO) указывает, какой объем данных допустимо потерять, если нарушение работы служб повлияет на функционирование системы.</span><span class="sxs-lookup"><span data-stu-id="e78c2-151">Recovery Point Objective (RPO) indicates how much data you can afford to lose if a disruption in service affects the system.</span></span>

<span data-ttu-id="e78c2-152">На практике под терминами RTO и RPO подразумеваются избыточность и резервное копирование.</span><span class="sxs-lookup"><span data-stu-id="e78c2-152">In practice, RTO, and RPO imply redundancy and backup.</span></span> <span data-ttu-id="e78c2-153">В глобальном облаке Azure доступность означает не восстановление оборудования (эта возможность предоставляется в Azure), а поддержание работоспособности систем DevOps.</span><span class="sxs-lookup"><span data-stu-id="e78c2-153">On the global Azure cloud, availability isn't a question of hardware recovery—that's part of Azure—but rather ensuring you maintain the state of your DevOps systems.</span></span> <span data-ttu-id="e78c2-154">В Azure Stack Hub поддерживается восстановление оборудования.</span><span class="sxs-lookup"><span data-stu-id="e78c2-154">On Azure Stack Hub, hardware recovery may be a consideration.</span></span>

<span data-ttu-id="e78c2-155">Еще одним важным положением проектировании системы, используемой для автоматизации развертывания, является управление доступом и правильное управление правами, необходимыми для развертывания служб в облачных средах.</span><span class="sxs-lookup"><span data-stu-id="e78c2-155">Another major consideration when designing the system used for deployment automation is access control and the proper management of the rights needed to deploy services to cloud environments.</span></span> <span data-ttu-id="e78c2-156">Какие права требуются для создания, удаления или изменения развертываний?</span><span class="sxs-lookup"><span data-stu-id="e78c2-156">What rights are needed to create, delete, or modify deployments?</span></span> <span data-ttu-id="e78c2-157">Например, один набор прав обычно требуется для создания группы ресурсов в Azure, а другой — для развертывания служб в группе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e78c2-157">For example, one set of rights is typically required to create a resource group in Azure and another to deploy services in the resource group.</span></span>

### <a name="manageability"></a><span data-ttu-id="e78c2-158">Управляемость</span><span class="sxs-lookup"><span data-stu-id="e78c2-158">Manageability</span></span>

<span data-ttu-id="e78c2-159">При проектированию любой системы, основанной на шаблоне DevOps, должны учитываться автоматизация, ведение журнала и оповещение для каждой службы в портфеле.</span><span class="sxs-lookup"><span data-stu-id="e78c2-159">The design of any system based on the DevOps pattern must consider automation, logging, and alerting for each service across the portfolio.</span></span> <span data-ttu-id="e78c2-160">Используйте общие службы, группу по приложениям или и то, и другое, а также следите за политиками безопасности и системой управления.</span><span class="sxs-lookup"><span data-stu-id="e78c2-160">Use shared services, an application team, or both, and track security policies and governance as well.</span></span>

<span data-ttu-id="e78c2-161">Развертывайте рабочие среды, а также среды разработки и тестирования в отдельных группах ресурсов в Azure или Azure Stack Hub.</span><span class="sxs-lookup"><span data-stu-id="e78c2-161">Deploy production environments and development/test environments in separate resource groups on Azure or Azure Stack Hub.</span></span> <span data-ttu-id="e78c2-162">Затем вы сможете отслеживать ресурсы каждой среды и выполнять сведение выставляемых счетов по группам ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e78c2-162">Then you can monitor each environment's resources and roll up billing costs by resource group.</span></span> <span data-ttu-id="e78c2-163">Можно также удалить ресурсы в виде набора, что очень удобно для тестирования развернутых служб.</span><span class="sxs-lookup"><span data-stu-id="e78c2-163">You can also delete resources as a set, which is useful for test deployments.</span></span>

## <a name="when-to-use-this-pattern"></a><span data-ttu-id="e78c2-164">Когда следует использовать этот шаблон</span><span class="sxs-lookup"><span data-stu-id="e78c2-164">When to use this pattern</span></span>

<span data-ttu-id="e78c2-165">Используйте этот шаблон в следующих случаях:</span><span class="sxs-lookup"><span data-stu-id="e78c2-165">Use this pattern if:</span></span>

- <span data-ttu-id="e78c2-166">Вы можете разработать код в одной среде, которая отвечает потребностям ваших разработчиков, и развернуть его в среде, подходящей для вашего решения, в которой может быть трудно разработать новый код.</span><span class="sxs-lookup"><span data-stu-id="e78c2-166">You can develop code in one environment that meets the needs of your developers, and deploy to an environment specific to your solution where it may be difficult to develop new code.</span></span>
- <span data-ttu-id="e78c2-167">Вы можете использовать код и инструменты, которые предпочитают ваши разработчики, если они способны обеспечить процесс непрерывной интеграции и непрерывной поставки в шаблоне DevOps.</span><span class="sxs-lookup"><span data-stu-id="e78c2-167">You can use the code and tools your developers would like, as long as they're able to follow the continuous integration and continuous delivery process in the DevOps Pattern.</span></span>

<span data-ttu-id="e78c2-168">Этот шаблон не рекомендуется использовать в следующих случаях:</span><span class="sxs-lookup"><span data-stu-id="e78c2-168">This pattern isn't recommended:</span></span>

- <span data-ttu-id="e78c2-169">Если вы не можете автоматизировать инфраструктуру, подготовку ресурсов, настройку, работу с удостоверениями и задачи по обеспечению безопасности.</span><span class="sxs-lookup"><span data-stu-id="e78c2-169">If you can't automate infrastructure, provisioning resources, configuration, identity, and security tasks.</span></span>
- <span data-ttu-id="e78c2-170">Если у команд нет доступа к гибридным облачным ресурсам для реализации непрерывной интеграции и непрерывного развертывания (CI/CD).</span><span class="sxs-lookup"><span data-stu-id="e78c2-170">If teams don't have access to hybrid cloud resources to implement a Continuous Integration/Continuous Development (CI/CD) approach.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e78c2-171">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="e78c2-171">Next steps</span></span>

<span data-ttu-id="e78c2-172">Дополнительные сведения по темам, описанным в этой статье:</span><span class="sxs-lookup"><span data-stu-id="e78c2-172">To learn more about topics introduced in this article:</span></span>

- <span data-ttu-id="e78c2-173">См. сведения об [Azure DevOps и связанных средствах, включая Azure Repos и Azure Pipelines](/azure/devops).</span><span class="sxs-lookup"><span data-stu-id="e78c2-173">See the [Azure DevOps documentation](/azure/devops) to learn more about Azure DevOps and related tools, including Azure Repos, and Azure Pipelines.</span></span>
- <span data-ttu-id="e78c2-174">См. сведения обо [всех продуктах и решениях Azure Stack](/azure-stack).</span><span class="sxs-lookup"><span data-stu-id="e78c2-174">See the [Azure Stack family of products and solutions](/azure-stack) to learn more about the entire portfolio of products and solutions.</span></span>

<span data-ttu-id="e78c2-175">Когда вы будете готовы протестировать пример решения, переходите к [руководству по развертыванию гибридного решения CI/CD](https://aka.ms/hybriddevopsdeploy).</span><span class="sxs-lookup"><span data-stu-id="e78c2-175">When you're ready to test the solution example, continue with the [DevOps hybrid CI/CD solution deployment guide](https://aka.ms/hybriddevopsdeploy).</span></span> <span data-ttu-id="e78c2-176">В этом руководстве содержатся пошаговые инструкции по развертыванию и тестированию компонентов.</span><span class="sxs-lookup"><span data-stu-id="e78c2-176">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span> <span data-ttu-id="e78c2-177">Вы узнали, как развернуть приложение в Azure и Azure Stack Hub с помощью гибридного конвейера непрерывной интеграции и непрерывной поставки (CI/CD).</span><span class="sxs-lookup"><span data-stu-id="e78c2-177">You learn how to deploy an app to Azure and Azure Stack Hub using a hybrid continuous integration/continuous delivery (CI/CD) pipeline.</span></span>
